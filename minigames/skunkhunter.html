<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Game</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 2px solid #000;
            background-color: #fff;
        }
    </style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const context = canvas.getContext('2d');

    let x = 175;
    let y = 125;
    const size = 50;
    const npcSize = 50;
    const keys = {};
    const npcSpeed = 2;
    const attackRange = 60;

    let health = 100;
    const maxHealth = 100;
    const power = 100;
    const maxPower = 100;
    const powerAttackCost = 20;

    let npcHealth = 50;
    const maxNpcHealth = 50;

    let isGameOver = false;
    let currentRound = 1;

    let droppedPotions = [];

    const playerImage = new Image();
    playerImage.src = 'https://cdn.discordapp.com/avatars/1208633283907158030/ed85bc245ae585b2a1586cf0c8661345.webp';

    const npcImage = new Image();
    npcImage.src = 'https://www.shutterstock.com/image-vector/chat-bot-icon-virtual-smart-600nw-2478937555.jpg';

    const potionImages = {
        regeneration: new Image(),
        power: new Image(),
        speed: new Image(),
    };

    potionImages.regeneration.src = 'https://static.wikia.nocookie.net/minecraft_gamepedia/images/e/e5/Splash_Potion_of_Regeneration_JE2_BE2.png/revision/latest/scale-to-width/360?cb=20191027041322';
    potionImages.power.src = 'https://static.wikia.nocookie.net/evolution-evade/images/0/06/Power_Potion.png/revision/latest?cb=20201231074314';
    potionImages.speed.src = 'https://static.wikia.nocookie.net/catalog-gear-place-official/images/2/22/Ultimate_Super_Speed_Potion.png/revision/latest/scale-to-width-down/420?cb=20210722211242';

    let npcX = Math.random() * (canvas.width - npcSize);
    let npcY = Math.random() * (canvas.height - npcSize);

    document.addEventListener('keydown', (event) => {
        keys[event.key] = true;
    });
    document.addEventListener('keyup', (event) => {
        keys[event.key] = false;
    });

    document.addEventListener('mousedown', (event) => {
        if (event.button === 0) {
            regularAttack();
        }
    });

    document.addEventListener('keydown', (event) => {
        if (event.code === 'Space') {
            powerAttack();
        }
    });

    function regularAttack() {
        if (npcHealth > 0) {
            npcHealth -= 5;
            if (npcHealth < 0) npcHealth = 0;
        }
    }

    function powerAttack() {
        if (power >= powerAttackCost && npcHealth > 0) {
            power -= powerAttackCost;
            npcHealth -= 10;
            if (npcHealth < 0) npcHealth = 0;
        }
    }

    function createDroppedPotion() {
        const potionType = Math.random();
        let potion = {
            type: '',
            x: Math.random() * (canvas.width - 20),
            y: Math.random() * (canvas.height - 20)
        };

        if (potionType < 0.45) {
            potion.type = 'regeneration';
        } else if (potionType < 0.55) {
            potion.type = 'power';
        } else {
            potion.type = 'speed';
        }

        droppedPotions.push(potion);
    }

    function checkPotionCollision() {
        for (let i = droppedPotions.length - 1; i >= 0; i--) {
            const potion = droppedPotions[i];
            if (x < potion.x + 20 && x + size > potion.x && y < potion.y + 20 && y + size > potion.y) {
                droppedPotions.splice(i, 1);
            }
        }
    }

    function checkPlayerCollision() {
        if (x < npcX + npcSize && x + size > npcX && y < npcY + npcSize && y + size > npcY) {
            health -= 1;
            if (health < 0) health = 0;
        }
    }

    function startNewRound() {
        currentRound++;
        npcHealth = maxNpcHealth;
        npcX = Math.random() * (canvas.width - npcSize);
        npcY = Math.random() * (canvas.height - npcSize);
    }

    function gameLoop() {
        context.clearRect(0, 0, canvas.width, canvas.height);

        if (keys['ArrowUp'] && y > 0) y -= 3;
        if (keys['ArrowDown'] && y < canvas.height - size) y += 3;
        if (keys['ArrowLeft'] && x > 0) x -= 3;
        if (keys['ArrowRight'] && x < canvas.width - size) x += 3;

        if (npcHealth > 0) {
            if (npcX < x) npcX += npcSpeed;
            if (npcX > x) npcX -= npcSpeed;
            if (npcY < y) npcY += npcSpeed;
            if (npcY > y) npcY -= npcSpeed;

            if (Math.abs(npcX - x) < attackRange && Math.abs(npcY - y) < attackRange) {
                health -= 1;
                if (health < 0) health = 0;
            }
        } else {
            createDroppedPotion();
            startNewRound();
        }

        checkPotionCollision();
        checkPlayerCollision();

        context.drawImage(playerImage, x, y, size, size);
        context.drawImage(npcImage, npcX, npcY, npcSize, npcSize);

        for (const potion of droppedPotions) {
            context.drawImage(potionImages[potion.type], potion.x, potion.y, 20, 20);
        }

        context.fillStyle = 'red';
        context.fillRect(10, 10, (health / maxHealth) * 200, 20);
        context.fillStyle = 'black';
        context.font = '20px Arial';
        context.fillText(`Round: ${currentRound}`, canvas.width - 100, 30);
        context.fillText(`Health: ${health}`, 10, 70);

        if (health <= 0) {
            isGameOver = true;
            context.fillStyle = 'black';
            context.font = '40px Arial';
            context.fillText('Game Over!', canvas.width / 2 - 100, canvas.height / 2);
            return;
        }

        requestAnimationFrame(gameLoop);
    }

    gameLoop();
</script>

</body>
</html>

</body>
</html>
